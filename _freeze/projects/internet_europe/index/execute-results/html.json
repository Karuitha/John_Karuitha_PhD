{
  "hash": "a6eace6b0b23f34114716e71539d6892",
  "result": {
    "markdown": "---\ntitle: \"Visualizing Internet Speed in Europe\"\nauthor: \"John Karuitha\"\ndate: \"2023-01-27\"\ncategories: [R, code, analysis, Tableau]\nimage: \"internet.png\"\n---\n\n\nThis post is a visualization of internet speed in Europe using R and ggplot2. I start by loading the packages and then read the data. This analysis is a replication of a visualization in Tableau available in my [Tableau public profile](https://public.tableau.com/app/profile/john.karuitha/viz/InternetSpeedinEurope2022/Dashboard1) on the link <https://public.tableau.com/app/profile/john.karuitha/viz/InternetSpeedinEurope2022/Dashboard1>.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load required packages ----\nif (!require(pacman)) {\n        install.packages(\"pacman\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: pacman\n```\n:::\n\n```{.r .cell-code}\npacman::p_load(\n        tidyverse, tidymodels, ggthemes, janitor,\n        rvest, countrycode, readxl, maps, mapproj\n)\n\n## load data ----\neuropenet <- read_xlsx(\"Average Internet Speeds Across Europe.xlsx\") %>%\n        clean_names() %>%\n        mutate(country_en = countrycode(\n                sourcevar = country,\n                origin = \"iso2c\",\n                destination = \"country.name\"\n        )) %>%\n        relocate(country_en, .after = country) %>%\n        mutate(country_en = case_when(\n                country == \"EL\" ~ \"Greece\",\n                country == \"BIH\" ~ \"Bosnia and Herzegovina\",\n                country == \"MDA\" ~ \"Moldova\",\n                country == \"UK\" ~ \"United Kingdom\",\n                country == \"XKO\" ~ \"Kosovo\",\n                TRUE ~ country_en\n        ))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in countrycode_convert(sourcevar = sourcevar, origin = origin, destination = dest, : Some values were not matched unambiguously: BIH, EL, MDA, UK, XKO\n```\n:::\n\n```{.r .cell-code}\nfull_data <- map_data(\"world\") %>%\n        inner_join(europenet, by = c(\"region\" = \"country_en\"))\n```\n:::\n\n\nNext, I create the map. Countries with higher internet speeds have a darker green hue.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Create a base map ----\nfull_data %>%\n        ggplot(aes(\n                x = long, y = lat, map_id = region,\n                fill = average_download_speed\n        )) +\n        geom_map(\n                map = full_data,\n                color = \"gray80\",\n                linewidth = 0.2\n        ) +\n        labs(x = \"\", y = \"\", title = \"Average Internet Download Speeds\") +\n        coord_map(\"ortho\", orientation = c(55, 16, 0)) +\n        theme_minimal() +\n        theme(\n                legend.title = element_blank(),\n                legend.position = \"bottom\",\n                legend.text = element_text(size = 5, face = \"italic\"),\n                axis.text = element_blank()\n        ) +\n        scale_fill_gradient_tableau(palette = \"Blue-Green Sequential\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}